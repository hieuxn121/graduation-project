let logger,models,StatusCodes,getErrorMsg,jwt_decode;_4b8‍.x([["default",()=>_4b8‍.o]]);_4b8‍.w("npmlog",[["default",["logger"],function(v){logger=v}]]);_4b8‍.w("../models",[["default",["models"],function(v){models=v}]]);_4b8‍.w("http-status-codes",[["StatusCodes",["StatusCodes"],function(v){StatusCodes=v}]]);_4b8‍.w("../utils/common",[["getErrorMsg",["getErrorMsg"],function(v){getErrorMsg=v}]]);_4b8‍.w("jwt-decode",[["default",["jwt_decode"],function(v){jwt_decode=v}]]);





const {
  sequelize
} = models;

_4b8‍.d({

  getUserInfo: async (req, res) => {
    try {
      var decoded = jwt_decode(req.body.token);
      _4b8‍.g.console.log('token: ', decoded);
      const [userInfo, _1] = await sequelize.query(
        "select * from users where user_Id = (:ID)",{
          replacements: {
            ID: decoded.userId
          }
        }
      );
      if (userInfo && userInfo.length) {
        const user = userInfo[0];
        return res.status(StatusCodes.OK).send({
          status: StatusCodes.OK,
          success: true,
          message: 'User Info successfully found',
          user: {
            id: user.user_id,
            first_name: user.first_name,
            last_name: user.last_name,
            email: user.email,
            phone_number: user.phone_number,
            address: user.address
          }
        });
      }
    } catch (error) {
      logger.error('get_user_info', getErrorMsg(error));
      let errStatusCode = StatusCodes.INTERNAL_SERVER_ERROR;
      return res.status(errStatusCode).send({
        status: StatusCodes.INTERNAL_SERVER_ERROR,
        success: false,
        message: 'User found failed',
      });
    }
  },

  updateUserInfo: async (req, res) => {
    const user = req.body;
    _4b8‍.g.console.log('user id: ', user.user_id);
    try {
      const [userInfo, _2] = await sequelize.query(
        "update users set first_name = (:first_name), last_name = (:last_name), email = (:email), phone_number = (:phone_number) where user_id = (:userId)",{
          replacements: {
            userId: user.user_id,
            first_name: user.first_name,
            last_name: user.last_name,
            email: user.email,
            phone_number: user.phone_number,
          }
        }
      );
      if (userInfo && userInfo.length) {
        return res.status(StatusCodes.OK).send({
          status: StatusCodes.OK,
          success: true,
          message: 'User Info successfully update',
          user: userInfo[0]
        });
      }
    } catch (error) {
      logger.error('update_user_info', getErrorMsg(error));
      let errStatusCode = StatusCodes.INTERNAL_SERVER_ERROR;
      return res.status(errStatusCode).send({
        status: StatusCodes.INTERNAL_SERVER_ERROR,
        success: false,
        message: 'User update failed',
      });
    }
  },
});